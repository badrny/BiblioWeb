á2
LC:\webapp\BiblioWeb\src\BiblioWebServicesCore\Controllers\BooksController.cs
	namespace 	!
BiblioWebServicesCore
 
.  
Controllers  +
{ 
[ 
Route 

(
 
$str 
) 
] 
public		 

class		 
BooksController		  
:		! "

Controller		# -
{

 
public 
IRepository 
Books  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
BooksController 
( 
IRepository *
books+ 0
)0 1
=>2 4
Books5 :
=; <
books= B
;B C
[ 	
HttpGet	 
] 
public 
ActionResult 
GetAll "
(" #
)# $
=>% '
Json( ,
(, -
Books- 2
.2 3
GetAll3 9
(9 :
): ;
.; <
ToList< B
(B C
)C D
)D E
;E F
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
IActionResult 
GetBook $
($ %
string% +
search, 2
,2 3
[4 5
Bind5 9
(9 :
Prefix: @
=A B
$strB I
)I J
]J K
stringL R
chaineS Y
)Y Z
{ 	
return 
Json 
( 
Books 
. 
GetAll $
($ %
)% &
.& '
Where' ,
(, -
a- .
=>/ 1
(2 3
a3 4
.4 5
Title5 :
): ;
.; <

StartsWith< F
(F G
chaineG M
,M N
StringComparisonO _
._ `
OrdinalIgnoreCase` q
)q r
)r s
. 
Select 
( 
p 
=> 
new  
{! "
id" $
=% &
p' (
.( )
Key) ,
,, -
label. 3
=4 5
p6 7
.7 8
Title8 =
}= >
)> ?
)? @
;@ A
} 	
[ 	
HttpGet	 
( 
$str  
)  !
]! "
public 
IActionResult 
GetBookTypes )
() *
)* +
=>, .
Json/ 3
(3 4
Books4 9
.9 :
GetTypes: B
(B C
)C D
)D E
;E F
[!! 	
HttpPost!!	 
]!! 
public"" 
IActionResult"" 
Create"" #
(""# $
[""$ %
FromBody""% -
]""- .
Book""/ 3
book""4 8
)""8 9
{## 	
if$$ 
($$ 
book$$ 
==$$ 
null$$ 
)$$ 
{%% 

BadRequest&& 
(&& 
)&& 
;&& 
}'' 
Books(( 
.(( 
Add(( 
((( 
book(( 
)(( 
;(( 
return)) 
Ok)) 
()) 
book)) 
))) 
;)) 
}** 	
[-- 	
HttpPost--	 
(-- 
$str-- 
)-- 
]-- 
public.. 
IActionResult.. 
Note.. !
(..! "
[.." #
FromBody..# +
]..+ ,
Book..- 1
book..2 6
)..6 7
{// 	
throw11 
new11 #
NotImplementedException11 -
(11- .
)11. /
;11/ 0
}22 	
[55 	
HttpPut55	 
(55 
$str55 
)55 
]55 
public66 
IActionResult66 
Put66  
(66  !
int66! $
id66% '
,66' (
[66) *
FromBody66* 2
]662 3
bool663 7
isRead668 >
)66> ?
{77 	
Books88 
.88 
Update88 
(88 
id88 
,88 
isRead88 #
)88# $
;88$ %
return99 
Ok99 
(99 
)99 
;99 
}:: 	
[<< 	
HttpPut<<	 
]<< 
public== 
void== 
Update== 
(== 
[== 
FromBody== $
]==$ %
Book==% )
book==* .
)==. /
=>==0 2
Books==3 8
.==8 9
Update==9 ?
(==? @
book==@ D
)==D E
;==E F
[@@ 	

HttpDelete@@	 
(@@ 
$str@@ 
)@@ 
]@@ 
publicAA 
intAA 
DeleteAA 
(AA 
stringAA  
idAA! #
)AA# $
{BB 	
stringCC 
[CC 
]CC 
idsCC 
=CC 
idCC 
.CC 
SplitCC #
(CC# $
$charCC$ '
)CC' (
;CC( )
longDD 
[DD 
]DD 
keysDD 
=DD 
newDD 
longDD "
[DD" #
idsDD# &
.DD& '
CountDD' ,
(DD, -
)DD- .
-DD/ 0
$numDD1 2
]DD2 3
;DD3 4
forEE 
(EE 
intEE 
iEE 
=EE 
$numEE 
;EE 
iEE 
<EE 
idsEE  #
.EE# $
CountEE$ )
(EE) *
)EE* +
;EE+ ,
iEE- .
++EE. 0
)EE0 1
keysFF 
[FF 
iFF 
-FF 
$numFF 
]FF 
=FF 
intFF !
.FF! "
ParseFF" '
(FF' (
idsFF( +
[FF+ ,
iFF, -
]FF- .
)FF. /
;FF/ 0
BooksGG 
.GG 
RemoveGG 
(GG 
keysGG 
)GG 
;GG 
returnHH 
keysHH 
.HH 
CountHH 
(HH 
)HH 
;HH  
}II 	
}JJ 
}KK í
CC:\webapp\BiblioWeb\src\BiblioWebServicesCore\Data\DBInitializer.cs
	namespace 	!
BiblioWebServicesCore
 
.  
Data  $
{ 
public 

class 
DBInitializer 
{ 
public 
static 
void 

Initialize %
(% &
BookContext& 1
context2 9
)9 :
{		 	
context

 
.

 
Database

 
.

 
EnsureCreated

 *
(

* +
)

+ ,
;

, -
if 
( 
context 
. 
Types 
. 
Any !
(! "
)" #
)# $
return 
; 
var	 
	bookTypes 
= 
new 
[ 
] 
{ 
new 
Type 
{ 
Label  
=! "
$str# >
}> ?
,? @
new 
Type 
{ 
Label  
=! "
$str# 0
}0 1
,1 2
new 
Type 
{ 
Label  
=! "
$str# :
}: ;
,; <
new 
Type 
{ 
Label  
=! "
$str# 3
}3 4
,4 5
new 
Type 
{ 
Label  
=! "
$str# 4
}5 6
,6 7
new 
Type 
{ 
Label  
=! "
$str# 9
}: ;
,; <
new 
Type 
{ 
Label  
=! "
$str# 7
}8 9
,9 :
new 
Type 
{ 
Label  
=! "
$str# +
}, -
,- .
new 
Type 
{ 
Label  
=! "
$str# =
}> ?
,? @
new 
Type 
{ 
Label  
=! "
$str# :
}; <
,< =
new 
Type 
{ 
Label  
=! "
$str# 4
}5 6
,6 7
new 
Type 
{ 
Label  
=! "
$str# D
}E F
,F G
new 
Type 
{ 
Label  
=! "
$str# 5
}6 7
,7 8
new 
Type 
{ 
Label  
=! "
$str# 7
}8 9
,9 :
new 
Type 
{ 
Label  
=! "
$str# 7
}8 9
,9 :
}   	
;  	 

foreach!! 
(!! 
Type!! 
bt!! 
in!! 
	bookTypes!!  )
)!!) *
{"" 
context## 
.## 
Types## 
.## 
Add## !
(##! "
bt##" $
)##$ %
;##% &
}$$ 
context%% 
.%% 
SaveChanges%% 
(%%  
)%%  !
;%%! "
}&& 	
}'' 
}(( Ÿ>
WC:\webapp\BiblioWeb\src\BiblioWebServicesCore\Migrations\20170828193510_InitDataBook.cs
	namespace 	!
BiblioWebServicesCore
 
.  

Migrations  *
{ 
public 

partial 
class 
InitDataBook %
:& '
	Migration( 1
{ 
	protected		 
override		 
void		 
Up		  "
(		" #
MigrationBuilder		# 3
migrationBuilder		4 D
)		D E
{

 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str 
, 
columns 
: 
table 
=> !
new" %
{ 
Key 
= 
table 
.  
Column  &
<& '
long' +
>+ ,
(, -
)- .
. 

Annotation #
(# $
$str$ D
,D E)
NpgsqlValueGenerationStrategyF c
.c d
SerialColumnd p
)p q
,q r
Author 
= 
table "
." #
Column# )
<) *
string* 0
>0 1
(1 2
nullable2 :
:: ;
true< @
)@ A
,A B
CoverSrc 
= 
table $
.$ %
Column% +
<+ ,
string, 2
>2 3
(3 4
nullable4 <
:< =
true> B
)B C
,C D
Date 
= 
table  
.  !
Column! '
<' (
DateTime( 0
>0 1
(1 2
)2 3
,3 4
Format 
= 
table "
." #
Column# )
<) *
int* -
>- .
(. /
)/ 0
,0 1
IsRead 
= 
table "
." #
Column# )
<) *
bool* .
>. /
(/ 0
)0 1
,1 2
Note 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
nullable0 8
:8 9
true: >
)> ?
,? @
Title 
= 
table !
.! "
Column" (
<( )
string) /
>/ 0
(0 1
nullable1 9
:9 :
true; ?
)? @
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% .
,. /
x0 1
=>2 4
x5 6
.6 7
Key7 :
): ;
;; <
} 
) 
; 
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str 
, 
columns   
:   
table   
=>   !
new  " %
{!! 
Key"" 
="" 
table"" 
.""  
Column""  &
<""& '
long""' +
>""+ ,
("", -
)""- .
.## 

Annotation## #
(### $
$str##$ D
,##D E)
NpgsqlValueGenerationStrategy##F c
.##c d
SerialColumn##d p
)##p q
,##q r
Label$$ 
=$$ 
table$$ !
.$$! "
Column$$" (
<$$( )
string$$) /
>$$/ 0
($$0 1
nullable$$1 9
:$$9 :
true$$; ?
)$$? @
}%% 
,%% 
constraints&& 
:&& 
table&& "
=>&&# %
{'' 
table(( 
.(( 

PrimaryKey(( $
((($ %
$str((% .
,((. /
x((0 1
=>((2 4
x((5 6
.((6 7
Key((7 :
)((: ;
;((; <
})) 
))) 
;)) 
migrationBuilder++ 
.++ 
CreateTable++ (
(++( )
name,, 
:,, 
$str,,  
,,,  !
columns-- 
:-- 
table-- 
=>-- !
new--" %
{.. 
Key// 
=// 
table// 
.//  
Column//  &
<//& '
long//' +
>//+ ,
(//, -
)//- .
.00 

Annotation00 #
(00# $
$str00$ D
,00D E)
NpgsqlValueGenerationStrategy00F c
.00c d
SerialColumn00d p
)00p q
,00q r
BookID11 
=11 
table11 "
.11" #
Column11# )
<11) *
long11* .
>11. /
(11/ 0
)110 1
,111 2
TypeID22 
=22 
table22 "
.22" #
Column22# )
<22) *
long22* .
>22. /
(22/ 0
)220 1
}33 
,33 
constraints44 
:44 
table44 "
=>44# %
{55 
table66 
.66 

PrimaryKey66 $
(66$ %
$str66% 2
,662 3
x664 5
=>666 8
x669 :
.66: ;
Key66; >
)66> ?
;66? @
table77 
.77 

ForeignKey77 $
(77$ %
name88 
:88 
$str88 7
,887 8
column99 
:99 
x99  !
=>99" $
x99% &
.99& '
BookID99' -
,99- .
principalTable:: &
:::& '
$str::( .
,::. /
principalColumn;; '
:;;' (
$str;;) .
,;;. /
onDelete<<  
:<<  !
ReferentialAction<<" 3
.<<3 4
Cascade<<4 ;
)<<; <
;<<< =
table== 
.== 

ForeignKey== $
(==$ %
name>> 
:>> 
$str>> 7
,>>7 8
column?? 
:?? 
x??  !
=>??" $
x??% &
.??& '
TypeID??' -
,??- .
principalTable@@ &
:@@& '
$str@@( .
,@@. /
principalColumnAA '
:AA' (
$strAA) .
,AA. /
onDeleteBB  
:BB  !
ReferentialActionBB" 3
.BB3 4
CascadeBB4 ;
)BB; <
;BB< =
}CC 
)CC 
;CC 
migrationBuilderEE 
.EE 
CreateIndexEE (
(EE( )
nameFF 
:FF 
$strFF *
,FF* +
tableGG 
:GG 
$strGG !
,GG! "
columnHH 
:HH 
$strHH  
)HH  !
;HH! "
migrationBuilderJJ 
.JJ 
CreateIndexJJ (
(JJ( )
nameKK 
:KK 
$strKK *
,KK* +
tableLL 
:LL 
$strLL !
,LL! "
columnMM 
:MM 
$strMM  
)MM  !
;MM! "
}NN 	
	protectedPP 
overridePP 
voidPP 
DownPP  $
(PP$ %
MigrationBuilderPP% 5
migrationBuilderPP6 F
)PPF G
{QQ 	
migrationBuilderRR 
.RR 
	DropTableRR &
(RR& '
nameSS 
:SS 
$strSS  
)SS  !
;SS! "
migrationBuilderUU 
.UU 
	DropTableUU &
(UU& '
nameVV 
:VV 
$strVV 
)VV 
;VV 
migrationBuilderXX 
.XX 
	DropTableXX &
(XX& '
nameYY 
:YY 
$strYY 
)YY 
;YY 
}ZZ 	
}[[ 
}\\ †/
TC:\webapp\BiblioWeb\src\BiblioWebServicesCore\Migrations\BookContextModelSnapshot.cs
	namespace 	!
BiblioWebServicesCore
 
.  

Migrations  *
{ 
[		 
	DbContext		 
(		 
typeof		 
(		 
BookContext		 !
)		! "
)		" #
]		# $
partial

 
class

 $
BookContextModelSnapshot

 *
:

+ ,
ModelSnapshot

- :
{ 
	protected 
override 
void 

BuildModel  *
(* +
ModelBuilder+ 7
modelBuilder8 D
)D E
{ 	
modelBuilder 
. 
HasAnnotation 
( 
$str ?
,? @)
NpgsqlValueGenerationStrategyA ^
.^ _
SerialColumn_ k
)k l
. 
HasAnnotation 
( 
$str /
,/ 0
$str1 8
)8 9
;9 :
modelBuilder 
. 
Entity 
(  
$str  B
,B C
bD E
=>F H
{ 
b 
. 
Property 
< 
long #
># $
($ %
$str% *
)* +
. 
ValueGeneratedOnAdd ,
(, -
)- .
;. /
b 
. 
Property 
< 
string %
>% &
(& '
$str' /
)/ 0
;0 1
b 
. 
Property 
< 
string %
>% &
(& '
$str' 1
)1 2
;2 3
b 
. 
Property 
< 
DateTime '
>' (
(( )
$str) /
)/ 0
;0 1
b 
. 
Property 
< 
int "
>" #
(# $
$str$ ,
), -
;- .
b 
. 
Property 
< 
bool #
># $
($ %
$str% -
)- .
;. /
b!! 
.!! 
Property!! 
<!! 
string!! %
>!!% &
(!!& '
$str!!' -
)!!- .
;!!. /
b## 
.## 
Property## 
<## 
string## %
>##% &
(##& '
$str##' .
)##. /
;##/ 0
b%% 
.%% 
HasKey%% 
(%% 
$str%% "
)%%" #
;%%# $
b'' 
.'' 
ToTable'' 
('' 
$str'' $
)''$ %
;''% &
}(( 
)(( 
;(( 
modelBuilder** 
.** 
Entity** 
(**  
$str**  F
,**F G
b**H I
=>**J L
{++ 
b,, 
.,, 
Property,, 
<,, 
long,, #
>,,# $
(,,$ %
$str,,% *
),,* +
.-- 
ValueGeneratedOnAdd-- ,
(--, -
)--- .
;--. /
b// 
.// 
Property// 
<// 
long// #
>//# $
(//$ %
$str//% -
)//- .
;//. /
b11 
.11 
Property11 
<11 
long11 #
>11# $
(11$ %
$str11% -
)11- .
;11. /
b33 
.33 
HasKey33 
(33 
$str33 "
)33" #
;33# $
b55 
.55 
HasIndex55 
(55 
$str55 '
)55' (
;55( )
b77 
.77 
HasIndex77 
(77 
$str77 '
)77' (
;77( )
b99 
.99 
ToTable99 
(99 
$str99 (
)99( )
;99) *
}:: 
):: 
;:: 
modelBuilder<< 
.<< 
Entity<< 
(<<  
$str<<  B
,<<B C
b<<D E
=><<F H
{== 
b>> 
.>> 
Property>> 
<>> 
long>> #
>>># $
(>>$ %
$str>>% *
)>>* +
.?? 
ValueGeneratedOnAdd?? ,
(??, -
)??- .
;??. /
bAA 
.AA 
PropertyAA 
<AA 
stringAA %
>AA% &
(AA& '
$strAA' .
)AA. /
;AA/ 0
bCC 
.CC 
HasKeyCC 
(CC 
$strCC "
)CC" #
;CC# $
bEE 
.EE 
ToTableEE 
(EE 
$strEE $
)EE$ %
;EE% &
}FF 
)FF 
;FF 
modelBuilderHH 
.HH 
EntityHH 
(HH  
$strHH  F
,HHF G
bHHH I
=>HHJ L
{II 
bJJ 
.JJ 
HasOneJJ 
(JJ 
$strJJ ?
,JJ? @
$strJJA G
)JJG H
.KK 
WithManyKK !
(KK! "
$strKK" )
)KK) *
.LL 
HasForeignKeyLL &
(LL& '
$strLL' /
)LL/ 0
.MM 
OnDeleteMM !
(MM! "
DeleteBehaviorMM" 0
.MM0 1
CascadeMM1 8
)MM8 9
;MM9 :
bOO 
.OO 
HasOneOO 
(OO 
$strOO ?
,OO? @
$strOOA G
)OOG H
.PP 
WithManyPP !
(PP! "
$strPP" )
)PP) *
.QQ 
HasForeignKeyQQ &
(QQ& '
$strQQ' /
)QQ/ 0
.RR 
OnDeleteRR !
(RR! "
DeleteBehaviorRR" 0
.RR0 1
CascadeRR1 8
)RR8 9
;RR9 :
}SS 
)SS 
;SS 
}TT 	
}UU 
}VV Í!
;C:\webapp\BiblioWeb\src\BiblioWebServicesCore\Model\Book.cs
	namespace 	!
BiblioWebServicesCore
 
.  
Model  %
{		 
public

 

class

 
Type

 
{ 
[ 	
Key	 
] 
[ 	
DatabaseGenerated	 
( #
DatabaseGeneratedOption 2
.2 3
Identity3 ;
); <
]< =
public 
long 
Key 
{ 
get 
; 
set "
;" #
}$ %
public 
string 
Label 
{ 
get !
;! "
set# &
;& '
}( )
public 
IList 
< 
BookType 
> 
Types $
{% &
get' *
;* +
set, /
;/ 0
}1 2
} 
public 

class 
BookType 
{ 
[ 	
Key	 
] 
[ 	
DatabaseGenerated	 
( #
DatabaseGeneratedOption 2
.2 3
Identity3 ;
); <
]< =
public 
long 
Key 
{ 
get 
; 
set "
;" #
}$ %
public 
long 
TypeID 
{ 
get  
;  !
set" %
;% &
}' (
public 
long 
BookID 
{ 
get  
;  !
set" %
;% &
}' (
[ 	

JsonIgnore	 
] 
public   
Book   
Book   
{   
get   
;   
set    #
;  # $
}  % &
["" 	

JsonIgnore""	 
]"" 
public## 
Type## 
Type## 
{## 
get## 
;## 
set##  #
;### $
}##% &
}$$ 
public&& 

class&& 
Book&& 
:&& 
IMedia&& 
{'' 
public(( 
enum(( 

BookFormat(( 
{)) 	
Pocket** 
,** 
Brochure++ 
,++ 
Degital,, 
}-- 	
[// 	
Key//	 
]// 
[00 	
DatabaseGenerated00	 
(00 #
DatabaseGeneratedOption00 2
.002 3
Identity003 ;
)00; <
]00< =
public11 
long11 
Key11 
{11 
get11 
;11 
set11 "
;11" #
}11$ %
public33 
string33 
Title33 
{33 
get33 !
;33! "
set33# &
;33& '
}33( )
public55 
string55 
Author55 
{55 
get55 "
;55" #
set55$ '
;55' (
}55) *
public77 
string77 
CoverSrc77 
{77  
get77! $
;77$ %
set77& )
;77) *
}77+ ,
public99 
string99 
Note99 
{99 
get99  
;99  !
set99" %
;99% &
}99' (
public;; 
IList;; 
<;; 
BookType;; 
>;; 
Types;; $
{;;% &
get;;' *
;;;* +
set;;, /
;;;/ 0
};;1 2
public== 

BookFormat== 
Format==  
{==! "
get==# &
;==& '
set==( +
;==+ ,
}==- .
public?? 
bool?? 
IsRead?? 
{?? 
get??  
;??  !
set??" %
;??& '
}??( )
publicAA 
DateTimeAA 
DateAA 
{AA 
getAA "
;AA" #
setAA$ '
;AA' (
}AA) *
publicCC 
BookCC 
(CC 
)CC 
{DD 	
IsReadEE 
=EE 
falseEE 
;EE 
NoteFF 
=FF 
$strFF 
;FF 
}GG 	
}HH 
}II ›
BC:\webapp\BiblioWeb\src\BiblioWebServicesCore\Model\BookContext.cs
	namespace 	!
BiblioWebServicesCore
 
.  
Model  %
{ 
public 

class 
BookContext 
: 
	DbContext (
{ 
public 
BookContext 
( 
DbContextOptions +
<+ ,
BookContext, 7
>7 8
options9 @
)@ A
: 
base 
( 
options 
) 
{		 	
} 	
public 
DbSet 
< 
Book 
> 
Books  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
DbSet 
< 
Type 
> 
Types  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
DbSet 
< 
BookType 
> 
	BookTypes (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
	protected 
override 
void 
OnModelCreating  /
(/ 0
ModelBuilder0 <
modelBuilder= I
)I J
{ 	
modelBuilder 
. 
Entity 
<  
Book  $
>$ %
(% &
)& '
.' (
ToTable( /
(/ 0
$str0 6
)6 7
;7 8
modelBuilder 
. 
Entity 
<  
Type  $
>$ %
(% &
)& '
.' (
ToTable( /
(/ 0
$str0 6
)6 7
;7 8
modelBuilder 
. 
Entity 
<  
BookType  (
>( )
() *
)* +
.+ ,
ToTable, 3
(3 4
$str4 >
)> ?
;? @
} 	
} 
} ß'
EC:\webapp\BiblioWeb\src\BiblioWebServicesCore\Model\BookRepository.cs
	namespace 	!
BiblioWebServicesCore
 
.  
Model  %
{ 
public 

class 
BookRepository 
:  !
IRepository" -
{		 
private

 
readonly

 
BookContext

 $
_context

% -
;

- .
public 
BookRepository 
( 
BookContext )
context* 1
)1 2
=>3 5
_context6 >
=? @
contextA H
;H I
public 
void 
Add 
( 
Book 
item !
)! "
{ 	
_context 
. 
Books 
. 
Add 
( 
item #
)# $
;$ %
_context 
. 
SaveChanges  
(  !
)! "
;" #
} 	
public 
Book 
Find 
( 
long 
key !
)! "
=># %
_context& .
.. /
Books/ 4
.4 5
Find5 9
(9 :
key: =
)= >
;> ?
public 
IEnumerable 
< 
Book 
>  
GetAll! '
(' (
)( )
{ 	
_context 
. 
Books 
. 
Load 
(  
)  !
;! "
_context 
. 
Types 
. 
Load 
(  
)  !
;! "
_context 
. 
	BookTypes 
. 
Load #
(# $
)$ %
;% &
return 
_context 
. 
Books !
;! "
} 	
public 
IEnumerable 
< 
BookType #
># $
GetBookTypes% 1
(1 2
)2 3
=>4 6
_context7 ?
.? @
	BookTypes@ I
;I J
public!! 
IEnumerable!! 
<!! 
Type!! 
>!!  
GetTypes!!! )
(!!) *
)!!* +
=>!!, .
_context!!/ 7
.!!7 8
Types!!8 =
.!!= >
ToList!!> D
(!!D E
)!!E F
;!!F G
public## 
void## 
Remove## 
(## 
long## 
[##  
]##  !
keys##" &
)##& '
{$$ 	
if%% 
(%% 
keys%% 
==%% 
null%% 
)%% 
throw%% #
new%%$ '!
ArgumentNullException%%( =
(%%= >
nameof%%> D
(%%D E
keys%%E I
)%%I J
)%%J K
;%%K L
foreach&& 
(&& 
var&& 
item&& 
in&&  
keys&&! %
)&&% &
{'' 
var(( 
entity(( 
=(( 
_context(( %
.((% &
Books((& +
.((+ ,
First((, 1
(((1 2
t((2 3
=>((4 6
t((7 8
.((8 9
Key((9 <
==((= ?
item((@ D
)((D E
;((E F
_context)) 
.)) 
Books)) 
.)) 
Remove)) %
())% &
entity))& ,
))), -
;))- .
_context** 
.** 
SaveChanges** $
(**$ %
)**% &
;**& '
}++ 
},, 	
public.. 
void.. 
Update.. 
(.. 
Book.. 
item..  $
)..$ %
{// 	
_context00 
.00 
Books00 
.00 
Update00 !
(00! "
item00" &
)00& '
;00' (
_context11 
.11 
SaveChanges11  
(11  !
)11! "
;11" #
}22 	
public44 
void44 
Update44 
(44 
int44 
id44 !
,44! "
bool44# '
isRead44( .
)44. /
{55 	
Book77 
book77 
=77 
_context77  
.77  !
Books77! &
.77& '
FirstOrDefault77' 5
(775 6
t776 7
=>778 :
t77; <
.77< =
Key77= @
==77A C
id77D F
)77F G
;77G H
book88 
.88 
IsRead88 
=88 
!88 
isRead88 !
;88! "
_context99 
.99 
Books99 
.99 
Update99 !
(99! "
book99" &
)99& '
;99' (
_context:: 
.:: 
SaveChanges::  
(::  !
)::! "
;::" #
};; 	
}<< 
}== ≈
=C:\webapp\BiblioWeb\src\BiblioWebServicesCore\Model\IMedia.cs
	namespace 	!
BiblioWebServicesCore
 
.  
Model  %
{ 
public 

	interface 
IMedia 
{ 
long 
Key 
{ 
get 
; 
set 
; 
} 
string 
Title 
{ 
get 
; 
set 
;  
}! "
string 
Author 
{ 
get 
; 
set  
;  !
}" #
System 
. 
DateTime 
Date 
{ 
get "
;" #
set$ '
;' (
}) *
}		 
}

 ·

BC:\webapp\BiblioWeb\src\BiblioWebServicesCore\Model\IRepository.cs
	namespace 	!
BiblioWebServicesCore
 
.  
Model  %
{ 
public 

	interface 
IRepository  
{ 
void 
Add 
( 
Book 
item 
) 
; 
IEnumerable 
< 
Book 
> 
GetAll  
(  !
)! "
;" #
IEnumerable		 
<		 
BookType		 
>		 
GetBookTypes		 *
(		* +
)		+ ,
;		, -
IEnumerable

 
<

 
Type

 
>

 
GetTypes

 "
(

" #
)

# $
;

$ %
Book 
Find 
( 
long 
key 
) 
; 
void 
Remove 
( 
long 
[ 
] 
keys 
)  
;  !
void 
Update 
( 
Book 
item 
) 
; 
void 
Update 
( 
int 
id 
, 
bool  
isRead! '
)' (
;( )
} 
} Ë	
8C:\webapp\BiblioWeb\src\BiblioWebServicesCore\Program.cs
	namespace 	!
BiblioWebServicesCore
 
{ 
public 

class 
Program 
{ 
public 
static 
void 
Main 
(  
string  &
[& '
]' (
args) -
)- .
{		 	
var

 
host

 
=

 
new

 
WebHostBuilder

 )
(

) *
)

* +
. 

UseKestrel 
( 
) 
. 
UseContentRoot 
(  
	Directory  )
.) *
GetCurrentDirectory* =
(= >
)> ?
)? @
. 
UseIISIntegration "
(" #
)# $
. 

UseStartup 
< 
Startup #
># $
($ %
)% &
. 
UseUrls 
( 
$str 0
)0 1
. 
Build 
( 
) 
; 
host 
. 
Run 
( 
) 
; 
} 	
} 
} ∫#
8C:\webapp\BiblioWeb\src\BiblioWebServicesCore\Startup.cs
	namespace 	!
BiblioWebServicesCore
 
{ 
public 

class 
Startup 
{ 
public 
Startup 
( 
IHostingEnvironment *
env+ .
). /
{ 	
var 
builder 
= 
new  
ConfigurationBuilder 2
(2 3
)3 4
. 
SetBasePath 
( 
env  
.  !
ContentRootPath! 0
)0 1
. 
AddJsonFile 
( 
$str /
,/ 0
optional1 9
:9 :
true; ?
,? @
reloadOnChangeA O
:O P
trueQ U
)U V
. 
AddJsonFile 
( 
$" 
appsettings. +
{+ ,
env, /
./ 0
EnvironmentName0 ?
}? @
.json@ E
"E F
,F G
optionalH P
:P Q
trueR V
)V W
;W X
if 
( 
env 
. 
IsEnvironment !
(! "
$str" /
)/ 0
)0 1
{ 
builder 
. *
AddApplicationInsightsSettings 6
(6 7
developerMode7 D
:D E
trueF J
)J K
;K L
} 
builder 
. #
AddEnvironmentVariables +
(+ ,
), -
;- .
Configuration 
= 
builder #
.# $
Build$ )
() *
)* +
;+ ,
} 	
public 
IConfigurationRoot !
Configuration" /
{0 1
get2 5
;5 6
}7 8
public"" 
void"" 
ConfigureServices"" %
(""% &
IServiceCollection""& 8
services""9 A
)""A B
{## 	
services%% 
.%% +
AddApplicationInsightsTelemetry%% 4
(%%4 5
Configuration%%5 B
)%%B C
;%%C D
services&& 
.&& 
AddCors&& 
(&& 
)&& 
;&& 
services)) 
.)) 
AddDbContext)) !
<))! "
BookContext))" -
>))- .
()). /
options))/ 6
=>))7 9
options))9 @
.))@ A
	UseNpgsql))A J
())J K
Configuration))K X
.))X Y
GetConnectionString))Y l
())l m
$str	))m Ä
)
))Ä Å
)
))Å Ç
)
))Ç É
;
))É Ñ
services** 
.** 
AddMvc** 
(** 
)** 
;** 
services++ 
.++ 
AddSingleton++ !
<++! "
IRepository++" -
,++- .
BookRepository++/ =
>++= >
(++> ?
)++? @
;++@ A
},, 	
public// 
void// 
	Configure// 
(// 
IApplicationBuilder// 1
app//2 5
,//5 6
IHostingEnvironment//7 J
env//K N
,//N O
ILoggerFactory//P ^
loggerFactory//_ l
,//l m
BookContext//n y
context	//z Å
)
//Å Ç
{00 	
loggerFactory11 
.11 

AddConsole11 $
(11$ %
Configuration11% 2
.112 3

GetSection113 =
(11= >
$str11> G
)11G H
)11H I
;11I J
loggerFactory22 
.22 
AddDebug22 "
(22" #
)22# $
;22$ %
app44 
.44 
UseCors44 
(44 
builder44 
=>44  "
builder44# *
.44* +
WithOrigins44+ 6
(446 7
$str447 N
)44N O
.55 
AllowAnyHeader55 
(55  
)55  !
.66 
AllowCredentials66 !
(66! "
)66" #
.77 
AllowAnyMethod77 
(77  
)77  !
)77! "
;77" #
app:: 
.:: 
UseMvc:: 
(:: 
):: 
;:: 
DBInitializer;; 
.;; 

Initialize;; $
(;;$ %
context;;% ,
);;, -
;;;- .
}<< 	
}== 
}>> 